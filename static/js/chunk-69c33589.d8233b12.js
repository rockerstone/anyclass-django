(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69c33589"],{"456d":function(e,t,l){var r=l("4bf8"),n=l("0d58");l("5eda")("keys",(function(){return function(e){return n(r(e))}}))},"5eda":function(e,t,l){var r=l("5ca1"),n=l("8378"),s=l("79e5");e.exports=function(e,t){var l=(n.Object||{})[e]||Object[e],o={};o[e]=t(l),r(r.S+r.F*s((function(){l(1)})),"Object",o)}},bff8:function(e,t,l){"use strict";l.r(t);var r=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"dashboard-container"},[l("el-card",{staticClass:"box-card",attrs:{shadow:"always"}},[l("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[l("div",{staticClass:"dashboard-text",staticStyle:{"text-align":"center"}},[e._v("课程管理")])]),e._v(" "),l("el-select",{staticClass:"el-table-add-row",staticStyle:{width:"100%"},attrs:{placeholder:"请选择所属学生课表",filterable:""},model:{value:e.student,callback:function(t){e.student=t},expression:"student"}},e._l(e.students,(function(e,t){return l("el-option",{key:t,attrs:{label:e[0]+" "+e[1],value:t}})})),1),e._v(" "),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.coursesLoading,expression:"coursesLoading"}],staticStyle:{width:"100%"},attrs:{data:e.courses,"element-loading-text":"Loading",stripe:"",border:""}},[l("el-table-column",{attrs:{prop:"real_name",label:"学生","min-width":"80",sortable:"",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{prop:"title",label:"课程名称","min-width":"200",sortable:"",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{prop:"week",label:"周数","min-width":"200",sortable:"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(t.row.week.toString()))]),l("br")]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"day",label:"星期","min-width":"80",sortable:"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(e.dayString[t.row.day]))]),l("br")]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"time",label:"时间","min-width":"120",sortable:"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(t.row.time.toString()))]),l("br")]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"",label:"操作",align:"center","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(l){return e.handleCourseDialog(t.row)}}},[e._v("编辑")]),e._v(" "),l("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(l){return e.handleCourseDelete(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),l("el-col",{attrs:{span:24}},[l("el-button",{staticClass:"el-table-add-row",attrs:{type:"info",plain:""},on:{click:function(t){return e.handleCourseDialog(e.courseNull)}}},[e._v(" + 添加 ")])],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"课程",visible:e.dialogFormVisible,width:"75%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[l("el-form",{ref:"COURSE",attrs:{model:e.course,rules:e.rules,"label-width":"auto","label-position":"left"}},[l("el-form-item",{attrs:{label:"课程名称",prop:"title"}},[l("el-input",{attrs:{autocomplete:"off"},model:{value:e.course.title,callback:function(t){e.$set(e.course,"title",t)},expression:"course.title"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"课程周数",prop:"week"}},[l("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择课程周数",filterable:"",multiple:""},model:{value:e.course.week,callback:function(t){e.$set(e.course,"week",t)},expression:"course.week"}},e._l(20,(function(e){return l("el-option",{key:e.toString(),attrs:{label:e.toString(),value:e.toString()}})})),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"课程星期",prop:"day"}},[l("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择课程星期",filterable:""},model:{value:e.course.day,callback:function(t){e.$set(e.course,"day",t)},expression:"course.day"}},e._l(e.dayString,(function(e,t){return l("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"课程时间",prop:"time"}},[l("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择课程时间",filterable:"",multiple:""},model:{value:e.course.time,callback:function(t){e.$set(e.course,"time",t)},expression:"course.time"}},e._l(10,(function(e){return l("el-option",{key:e.toString(),attrs:{label:"第"+e+"节课",value:e.toString()}})})),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"学生",prop:"student"}},[l("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择课表所属学生",filterable:""},model:{value:e.course.student,callback:function(t){e.$set(e.course,"student",t)},expression:"course.student"}},e._l(e.students,(function(e,t){return l("el-option",{key:t,attrs:{label:e[0]+" "+e[1],value:t}})})),1)],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:e.cancelCourseDialog}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:e.confirmCourseDialog}},[e._v("保 存")])],1)],1)],1)},n=[],s=(l("28a5"),l("6b54"),l("456d"),l("ac6a"),l("db72")),o=l("2f62"),a=l("b775");function i(e){return Object(a["a"])({url:"/courses/",method:"post",data:e})}function u(e){return Object(a["a"])({url:"/courses/?student="+e,method:"get"})}function c(e,t){return Object(a["a"])({url:"/courses/"+e+"/",method:"put",data:t})}function d(e){return Object(a["a"])({url:"/courses/"+e+"/",method:"delete"})}var f=l("2bfd"),b={name:"Course",data:function(){return{students:{},student:null,courses:null,course:{id:null,title:null,week:null,day:null,time:null,student:null,real_name:null},courseNull:{id:null,title:null,week:null,day:null,time:null,student:null,real_name:null},coursesLoading:!0,dialogFormVisible:!1,dayString:{1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六",7:"星期日"},rules:{title:[{required:!0,message:"请输入课程名称",trigger:"blur"}],week:[{required:!0,message:"请选择课程周数",trigger:"blur"}],day:[{required:!0,message:"请选择课程星期",trigger:"blur"}],time:[{required:!0,message:"请选择课程时间",trigger:"blur"}],student:[{required:!0,message:"请选择课程所属学生",trigger:"blur"}]}}},computed:Object(s["a"])({},Object(o["b"])(["name","role"])),watch:{student:function(){this.fetchCourse()}},created:function(){this.fetchStudentCourse()},methods:{fetchStudentCourse:function(){var e=this;Object(f["c"])().then((function(t){t.forEach((function(t){e.students[t.id]=[t.student_id,t.real_name]})),e.student=Object.keys(e.students)[0],e.fetchCourse()}))},fetchCourse:function(){var e=this;this.coursesLoading=!0,u(this.student).then((function(t){t.forEach((function(t){t["real_name"]=e.students[t.student][1],t["student"]=t["student"].toString(),t["week"]=t["week"].split(","),t["time"]=t["time"].split(",")})),e.courses=t,e.coursesLoading=!1}))},handleCourseDialog:function(e){this.course=JSON.parse(JSON.stringify(e)),this.dialogFormVisible=!0,this.$refs["COURSE"].resetFields()},cancelCourseDialog:function(){this.dialogFormVisible=!1},confirmCourseDialog:function(){var e=this;this.$refs["COURSE"].validate((function(t){if(!t)return console.log("error submit!!"),!1;e.course.week=e.course.week.toString(),e.course.time=e.course.time.toString(),null===e.course.id?e.handleCourseCreate(e.course):e.handleCourseEdit(e.course),e.dialogFormVisible=!1}))},handleCourseCreate:function(e){var t=this;i(e).then((function(){t.fetchCourse()}))},handleCourseEdit:function(e){var t=this;c(e.id,e).then((function(){t.fetchCourse()}))},handleCourseDelete:function(e){var t=this;d(e).then((function(){t.fetchCourse()}))}}},m=b,p=(l("ee34"),l("2877")),h=Object(p["a"])(m,r,n,!1,null,"910cd574",null);t["default"]=h.exports},ee34:function(e,t,l){"use strict";var r=l("f0b1"),n=l.n(r);n.a},f0b1:function(e,t,l){}}]);